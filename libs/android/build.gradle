String getVersion() {
  def compileSdkVersion = Integer.parseInt(project.android.compileSdkVersion.split("-")[1])
  return compileSdkVersion >= 28 ? "28.0.0" : "24.1.1+" 
}

repositories {
  google()
  mavenCentral()
  repositories {
    maven { url 'https://pkgs.dev.azure.com/OutSystemsRD/9e79bc5b-69b2-4476-9ca5-d67594972a52/_packaging/PublicArtifactRepository/maven/v1' }
  }
}

apply plugin: 'kotlin-kapt'

android{
  compileOptions {
    sourceCompatibility JavaVersion.VERSION_1_8
    targetCompatibility JavaVersion.VERSION_1_8
  }
  buildFeatures {
    viewBinding true
  }
}

dependencies {
  implementation fileTree(include: ['*.aar'], dir: 'libs')

  implementation 'androidx.core:core-ktx:1.7.0'
  implementation 'androidx.appcompat:appcompat:1.4.1'
  implementation 'com.google.android.material:material:1.5.0'
  implementation 'androidx.constraintlayout:constraintlayout:2.1.3'
  implementation("com.github.outsystems:oscore-android:1.1.0@aar")
  implementation("com.github.outsystems:oscordova-android:1.1.0@aar")
  implementation("com.github.outsystems:oscamera-android:1.1.0.10@aar")

  def camerax_version = "1.1.0"
  implementation "androidx.camera:camera-core:${camerax_version}"
  implementation "androidx.camera:camera-camera2:${camerax_version}"
  implementation "androidx.camera:camera-lifecycle:${camerax_version}"
  implementation "androidx.camera:camera-video:${camerax_version}"

  implementation "androidx.camera:camera-view:${camerax_version}"
  implementation "androidx.camera:camera-extensions:${camerax_version}"

  // Libs camera
  // Concurrent library for asynchronous coroutines
  implementation 'androidx.concurrent:concurrent-futures-ktx:1.1.0'
  implementation 'androidx.lifecycle:lifecycle-runtime-ktx:2.3.1'
}

// Defer the definition of the dependencies to the end
// of the "configuration" phase from the app build.gradle file
// so that we can inquire the proper compile sdk version being used.
cdvPluginPostBuildExtras.push({
  dependencies {
    implementation "com.android.support:support-v4:${getVersion()}"
  }
})
